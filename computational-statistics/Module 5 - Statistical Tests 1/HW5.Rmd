---
title: "HW#5"
author: "Milad Tatari"
date: "2/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
1. You teacher has a friend, Dr. Huang, he thinks his maximum fastball velocity is faster than average adult. His max veloity is 52 miles per hour (True story). So you teacher measured 100 randomly selected adult, and obtain a mean velocity of 48 miles per hour, and standard deviation of 5 miles per hour(This part is fiction). Please answer the following questions, measure in miles per hour(mph) and show your work for each question.

1.a. Formalize the null hypothesis.
1.b. What’s the alternative hypothesis?
1.c. What is test statistic can you use to test the hypothesis?
1.d. Do you prefer a one-tailed or two-tailed test in this case? Explain why
1.e. What is your α and threshold (t-statistic) value or values for your rejection region? (Whatever
you prefer is fine, just be sure to state it and explain why you chose it.)
1.f.Can you reject the null under a one-tailed test?
1.g.Can you reject the null under a two-tailed test?
1.h. What is the 95% confidence interval of the test?
1.i. What is the p-value of the test results?

# Solution

Population = The velocity of adults in the world (Or the US)


$$Sample: n=100, \overline{x} = 48, \mu=52, S_e=\frac{S}{\sqrt n}=\frac{5}{\sqrt {100}}=0.5$$
Null Hypothesis: miu_population=52, Research hypothesis. $\mu<52$ 
***Average velocity of adults is smaller than Dr. Huang's maximum fastball velocity. (fastball velocity is greater)
$H_{0}: \mu=52$
Alternative hypothesis can be
$$\mu_{population}>52$$



if we can reject the null hypothesis for 52, we would defenitly have rejected any null hypothesis for miu_population=51,50,49,…..

$$TestStatistics=\frac{\overline{x}-\mu}{S_e}=\frac{48-52}{0.5}=-8$$
According to the hypothesis, it is sufficient to do the “one-tailed test”. Here, I would rather to do the “two-tailed test”" first, to be more conservative, which means there are two rejection regions and two rejection thresholds, a high and a low. Once we rejected the Null hypothesis for the two tailed test, we would be assured to get the same result for one-tailed test.

I will choose alpha=0.05 as one of the most common values for alpha that is quite an adequately conservative value. Error Type I=0.05 or p-value=0.95.

Now let's compute the threshold (t statistic) values for the rejection region:
```{r}
Upper<-qt(.975,99) 
print(Upper)
```
```{r}
Lower<-qt(.025,99) 
print(Lower)
```

Our critical value (rejection region) is any t statistic greater than 1.98 or less than -1.98.

So we have:

$$-1.98< ... <1.98 *tstatistics* NOT*in* this *region$$

8 is clearly in the rejection region so we can reject the null hypothesis in favor of the research hypothesis. (if it passes the two-tailed test, it would have passed the one-tailed test as well) Thus we reject our existing theory that the average speed of adults was highr than his maximum fastball velocity.

we CAN REJECT the null hypothesis that mu=52. 

The Confidence Interval CI is:
$$CI=\overline{x}\pm  t*\frac{S}{\sqrt{n}}=48\pm(-8)\frac{5}{10}=48\pm4$$

we can directly calculated our p-value, which would be the area in the right tail greater than 8 plus the symmetrical area in the left tail.
Since the t-statistics is negetive, the p-value is pt(tstatistics,99)(n=100 assumption)
```{r}
pt(-8,99)
```


2. Your friend thinks that men and women have different skill levels in playing Tetris - for whatever reason -. To test this, you have 50 men and 50 women play the game in a controlled setting. The mean score of the men is 1,124 with a standard deviation of 200 and the mean score for the women is 1,245, also with a standard deviation of 200
2.a. Test if the male average is statistically greater than the female average.
2.b. Test if the female average is statistically greater than the male average.
2.c. Test if the two averages are different.

Men sample is:
$$n_1=50, \overline{x}_1=1124,S_1=200,Se_1=\frac{S_1}{\sqrt{50}}=28.28$$
Women sample is:
$$n_2=50, \overline{x}_2=1245,S_2=200,Se_2=\frac{S_2}{\sqrt{50}}=28.28$$

Let's calculate the test statistics:

$$TestStatistics=\frac{\overline{x}_2-\overline{x}_1}{Se_{diff}}\\Se_{diff}=\sqrt{Se_1^2+Se_2^2}=40\\TestStatistics=\frac{1245-1124}{40}=3.024$$

since n1=n2 and s1=s2, degree of freedom is calcuated as :
$$df=2n-2=98$$

Now let's compute the threshold (t statistic) values for the rejection region:
a)

$$H_a: \mu_1>\mu_2$$
If we were to perform an upper, one-tailed test, the critical value would be t(1-α,df) = 1.66055. T (3.024) is greater than 1.66. so it Will be rejected.  
```{r}
T<-qt(.95,98) 
print(T)
```

b)
$$H_a: \mu_1<\mu_2$$

```{r}
L<-qt(.05,98) 
print(L)
```
since T (3.024) is not smaller than -1.66, We cannot reject this hypothesis. 

c) 
$$\mu_1*not *equal *to *\mu_2$$
```{r}
Upper<-qt(.975,98) 
print(Upper)
```
```{r}
Lower<-qt(.025,98) 
print(Lower)
```
The absolute value of the test statistic for our example, 3.024, is greater than the critical value of 1.9844, so we reject the null hypothesis and conclude that the two population means are different at the 0.05 significance level. 




3. You think drinking the night before an exam might help performance on the exam the next
morning. To test this, you select 100 of your closest friends, and randomly get 50 of them drunk the night before the exam, which you denote the treatment group. The next day, the treatment group gets a mean of 78 with a standard deviation of 10 and the control group gets a 75 with a standard deviation of 5.
Does the evidence show that drinking helped exam performance?

# Solution
The variable is the score. 

drunk sample:
$$n_1=50, \overline{x}_1=78,S_1=10,Se_1=\frac{S_1}{\sqrt{50}}=1.41$$

Control group:
$$n_2=50, \overline{x}_2=75,S_2=5,Se_2=\frac{S_2}{\sqrt{50}}=0.7071$$
Now, we need to find tstatistics of two samples:
$$TestStatistics=\frac{\overline{x}_2-\overline{x}_1}{Se_{diff}}\\Se_{diff}=\sqrt{Se_1^2+Se_2^2}=1.58\\TestStatistics=\frac{78-75}{1.58}=1.9$$

Let's calculate the degree of freedom (df) as following:

$$df=\frac{Se_{diff}^4}{\frac{Se_1^4}{50-1}+\frac{Se_2^4}{50-1}}=\\\frac{1.58^4}{\frac{1.41^4}{50-1}+\frac{0.71^4}{50-1}}=72.6 \sim73$$
Now, we consider Error TypeI =0.05 or p-value=0.95 to calculate the threshold(t statistic) values for the rejection region:
```{r}
lower<-qt(0.025,73)
print(lower)
```


```{r}
upper<-qt(.975,73)
print(upper)
```

Since the Test Statistics lies on the region:



4. Using data of your choosing use R to conduct the following tests, and explain (i.e. interpret) the results you get. You can download your own data from the internet - in such case provide a link to it - or data from R’s built-in datasets as long as you are not using the class examples for this week:
4.a. A standard one-sample hypothesis test.
4.b. A difference-in-means test with independent samples.
4.c. A difference-in-means test with dependent samples (ie, a paired t-test).
4.d. Manually verify the results in (a) using the mean and sd as calculated by R (i.e, you don’t have to manually calculate the mean or sd by hand!).

# Solution
```{r}
t.test(cars$dist,alternative="two.sided",mu=70)  

```

The results show that assuming the Null Hypothesis or mu=70 is equivalent to:

$$P(35.65<\mu<50.303)= 0.95$$
Since Null mu=70 is out of the interval, our Null Hypothesis is rejected. It says that an appropriate estimate for mu is 42.98.

b)
We want to look at the event whether smoking reduces time life or not. We have got some data about the life time of two groups of people smokers and nonsmokers as:

```{r}
nonsmokers = c(50,60,57,35,79,76,77,63,79,80)
smokers = c(27,80,45,76,60,56,77,54,65,86)
t.test(nonsmokers,smokers,mu=0,conf=0.95,alternative="two.sided")
```

we see that assuming the Null Hypothesis: differences in average (mu=0) give us:
$$P(-12.75<\mu<18.75)= 0.95$$
Since mu=0 is in the interval, the Null Hypothesis is  NOT rejected. 

c)
A high school has hired a couple of instructors to work with students for a 3 month period to prepare them for the university exam. We have got the results of their exams at the begining of the training period and at the end to see its effectiveness.  we have:

Before training: 80.8, 79, 65, 60, 62.5, 78, 90, 91, 59, 69 After training: 81, 91, 92, 66, 78, 76, 90, 94, 97, 77
```{r}
bef.train = c(80.8, 79, 65, 60, 62.5, 78, 90, 91, 59, 69)
after.train = c(81, 91, 92, 66, 78, 76, 90, 94, 97, 77)
t.test(bef.train,after.train,mu=0,conf.level = 0.95,paired = TRUE)
```

we see that assuming the Null Hypothesis: differences in average (mu=0) give us:
$$P(-20.03<\mu<-1.5029)= 0.95$$
ince mu=0 is out of the interval, the Null-Hypothesis is rejected. A good estimate for mu(mean difference) is -10.77.

d)
```{r}
x.ave<-mean(cars$dist)
print(x.ave)
s<-sd(cars$dist)
print(s)
n<-length(cars$dist)
print(n)
se<-s/(sqrt(n))
print(se)
mu0<-70
t<-(x.ave-mu0)/se
print(t)

low.int<-qt(0.025,n-1)
print(low.int)
hig.int<-qt(0.975,n-1)
print(hig.int)
low.miu.95<-((low.int)*se)+x.ave
hig.miu.95<-((hig.int)*se)+x.ave
print(low.miu.95)
print(hig.miu.95)
```

We see that our results are same as what has been derived in part a. and the Null Hypothesis was rejected.


